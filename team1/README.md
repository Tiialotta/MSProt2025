---
title: "Capstone project - SOX9-dependent fibrosis, proteomics analysis"
output:
  pdf_document: default
  html_notebook: default
---

Libraries

``` r
library(rpx)
library(mzR)
library(MSnbase)
library(dplyr)
library(PSMatch)
library(msdata)
library(readr)
library(stringr)
library(RSQLite)
library(DBI)
library(QFeatures)
library(tidyverse)
library(stringr)
library(ggpubr)
library(msqrob2)
library(factoextra)
```



Retrieve mzML files from PRIDE 

``` r
#px <- PXDataset("PXD061542")

listFiles <- list.files(path="/Users/castleti/Library/Caches/org.R-project.R/R/rpx", 
                        pattern = "*.mzML$",
                        full.names = TRUE)  # List the path to raw .mzML files 

keep <- grepl("Tsiokas", listFiles) # there's some other stuff in the folder, keep only the ones corresponding to PXD061542

listFiles <- listFiles[keep]
```

To convert the .mzML files containing the raw data to .mzID files with the peptide/protein identification results, we used the external tool searchgui () (parameters (?)). To facilitate the downstream analysis in R, we converted the mzID files to .csv files (using a separate Python script).
Here, I'm trying to achieve a similar result calling EncyclopeDIA (an alternative tool to identify peptide/proteins from the raw data). EncyclopeDIA was the tool used in the original paper. 

Invoking EncyclopeDIA via R

``` r
Sys.setenv(JAVA_HOME = "/opt/homebrew/opt/openjdk/libexec/openjdk.jdk/Contents/Home/") # for R to be able to locate JAVA, which is needed to execute EncyclopeDIA 
```


``` r
encyclopeDIA_jar <- "~/Downloads/encyclopedia-4.7.11-executable.jar" # define path to the EncyclopeDIA executable 

# Mus musculus prosit-generated dlib to use as scaffold for DIA analysis. From Scaffold (https://support.proteomesoftware.com/hc/en-us/articles/360035151172-Prosit-Derived-Spectral-Libraries-for-Scaffold-DIA-Searches#h_01FE1R4118YYKAG5WRHYFCG767). 
# The library predicts DIA-specific libraries from all possible +2H and +3H peptides in the FASTA database, and reportedly they perform as well as libraries generated by DDA library-generating experiments. 
libraryFile <- "~/Desktop/Proteomics/CapstoneProjectTeam1/data/to_run/mus_musculus_prosit_generated_library.dlib"

# Use the M. musculus fasta file provided by Scaffold (https://support.proteomesoftware.com/hc/en-us/articles/360035151172-Prosit-Derived-Spectral-Libraries-for-Scaffold-DIA-Searches#h_01FE1R4118YYKAG5WRHYFCG767)
# with the library file 
ref <- "~/Desktop/Proteomics/CapstoneProjectTeam1/data/to_run/mus_musculus_reviewed_uniprot.fasta"

# Specify output directory 
output_dir <- "~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out2"
#output2_dir <- "~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/quant"

# Construct command to run EncyclopeDIA within R - this generates a Chromatogram Library in ELIB format. The tool also uses the M. musculus reference proteome as a search background.
mzmlFiles <-  list.files(path="/Users/castleti/Library/Caches/org.R-project.R/R/rpx", 
                        pattern = "*.mzML$",
                        full.names = TRUE)

## Uncomment to run, takes ~2 h per file 
# for (mzml in mzmlFiles){
#   outFile <- file.path(output_dir, paste0(basename(tools::file_path_sans_ext(mzml))))
# 
#   cmd <- paste("java -Xmx20G -jar", encyclopeDIA_jar,
#              "-l", libraryFile,
#              "-i", mzml,
#              "-f", ref)
#   cat("Running:", mzml, "\n")
#   # Run
#   #system(cmd)
# } 
## This outputs several files, among which are graphs that serve as QC. This only identifies peptides / proteins but does not provide quantification results that can be used to comparae between samples (since it is a DIA experiment, the quantification engine chooses the best ions from each sample for quantification and it does not make sense to do it per sample because the best ion might differ from sample to sample)
```


To run Encyclopedia to generate global quantitative results 

``` r
## Uncoment to run 
# cmd <- paste("java -Xmx12G -jar", encyclopeDIA_jar,
#              "-l", libraryFile,
#              "-i", "~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/",
#              "-f", ref,
#              "-libexport",
#              "-a true",
#              "-o ~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/output.elib")
#   
# 
#   #cat("Running:", mzml,"\n")
#   # Run
# system(cmd)
```


Glimpse at the features file, which contains the raw match-level data between the spectra and library peptides. These are the ones we use to create the PSM object

``` r
feat <- read.table("~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzML.features.txt", header = T)

output_concatenated <- read.table("~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/output_concatenated_features.txt", header = T)

colnames(output_concatenated) 
```

```
##  [1] "id"                                  "Label"                               "ScanNr"                             
##  [4] "consistencyScore"                    "absDeltaDeltaRT"                     "irqDeltaRT"                         
##  [7] "primary"                             "evalue"                              "correlationToGaussian"              
## [10] "correlationToPrecursor"              "isIntegratedSignal"                  "isIntegratedPrecursor"              
## [13] "numPeaksWithGoodCorrelation"         "HyperScore"                          "xCorrLib"                           
## [16] "xCorrModel"                          "scribe"                              "numberOfMatchingPeaks"              
## [19] "numberOfMatchingPeaksAboveThreshold" "averageFragmentDeltaMasses"          "isotopeDotProduct"                  
## [22] "averageParentDeltaMass"              "lnSp"                                "maxLadderLength"                    
## [25] "deltaRT"                             "ms1MassError"                        "ms2MassError"                       
## [28] "numMissedCleavage"                   "pepLength"                           "charge1"                            
## [31] "charge2"                             "charge3"                             "charge4"                            
## [34] "precursorMz"                         "precursorMass"                       "RTinMin"                            
## [37] "sequence"                            "Proteins"
```

Glimpse at the output elib files

``` r
elibFile <- "data/results/encyclopeDIA_out/bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzML.elib"

#con <- dbConnect(RSQLite::SQLite(), elibFile)

#dbListTables(con)
```


``` r
precursors <- dbReadTable(con, "peptidescores")

# View columns
str(precursors)
```

```
## 'data.frame':	26810 obs. of  7 variables:
##  $ PrecursorCharge          : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ PeptideModSeq            : chr  "GLGTDEDSILNLLTSR" "DITYFIQQLLR" "DITAEATPALAQTLPGGK" "LQVSNVLSQPLAQAAVK" ...
##  $ PeptideSeq               : chr  "GLGTDEDSILNLLTSR" "DITYFIQQLLR" "DITAEATPALAQTLPGGK" "LQVSNVLSQPLAQAAVK" ...
##  $ SourceFile               : chr  "bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml" "bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml" "bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml" "bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml" ...
##  $ QValue                   : num  7.61e-05 7.61e-05 7.61e-05 7.61e-05 7.61e-05 ...
##  $ PosteriorErrorProbability: num  1.73e-14 1.01e-13 1.71e-13 1.75e-13 2.12e-13 ...
##  $ IsDecoy                  : int  0 0 0 0 0 0 0 0 0 0 ...
```

``` r
head(precursors)
```

```
##   PrecursorCharge      PeptideModSeq         PeptideSeq                                             SourceFile
## 1               2   GLGTDEDSILNLLTSR   GLGTDEDSILNLLTSR bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## 2               2        DITYFIQQLLR        DITYFIQQLLR bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## 3               2 DITAEATPALAQTLPGGK DITAEATPALAQTLPGGK bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## 4               2  LQVSNVLSQPLAQAAVK  LQVSNVLSQPLAQAAVK bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## 5               2  STAADSGPVLLQAQTTR  STAADSGPVLLQAQTTR bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## 6               2   VMQQQQQATQQQLPQK   VMQQQQQATQQQLPQK bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
##        QValue PosteriorErrorProbability IsDecoy
## 1 7.61391e-05               1.72505e-14       0
## 2 7.61391e-05               1.00703e-13       0
## 3 7.61391e-05               1.70732e-13       0
## 4 7.61391e-05               1.75419e-13       0
## 5 7.61391e-05               2.12048e-13       0
## 6 7.61391e-05               2.78030e-13       0
```

Create PSM object from EncyclopeDIA .tsv files: 

``` r
# list feature files
#data/results/encyclopeDIA_out
targetFiles_fromEncyclopeDIA <- list.files("~/Desktop/Proteomics/CapstoneProjectTeam1/data/results/encyclopeDIA_out/", pattern = "*features.txt$", full.names = T)
# decoyFiles_fromEncyclopeDIA <- list.files("data/results/encyclopeDIA_out/", pattern = "*encyclopedia.decoy.txt", full.names = T)

#df <- read_table("data/results/encyclopeDIA_out/bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzML.encyclopedia.txt")
# Do not take the output file that contains the integated analysis
targetFiles_fromEncyclopeDIA <- targetFiles_fromEncyclopeDIA[grep("output", targetFiles_fromEncyclopeDIA, invert = T)]

# First, we combined all files into 1 data frame
all_feat <- lapply(targetFiles_fromEncyclopeDIA, function(f){
  df <- read_table(f)
  source_file <- basename(f)
  df$sample <- gsub("\\..*", "", source_file) # to keep track of the different samples
  # Add groups (WT vs KO) 
  df <- df %>% 
    mutate(group = case_when(
    str_detect(string = sample, pattern = "EV") ~ "WT",
    str_detect(string = sample, pattern = "Parental") ~ "WT",
    TRUE ~ "KO"
  ))
  return(df)
}) %>% bind_rows()
```

```
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
## 
## 
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sequence = col_character(),
##   Proteins = col_character()
## )
## ℹ Use `spec()` for the full column specifications.
```

``` r
colnames(all_feat)
```

```
##  [1] "id"                                  "Label"                               "ScanNr"                             
##  [4] "primary"                             "evalue"                              "correlationToGaussian"              
##  [7] "correlationToPrecursor"              "isIntegratedSignal"                  "isIntegratedPrecursor"              
## [10] "numPeaksWithGoodCorrelation"         "HyperScore"                          "xCorrLib"                           
## [13] "xCorrModel"                          "scribe"                              "numberOfMatchingPeaks"              
## [16] "numberOfMatchingPeaksAboveThreshold" "averageFragmentDeltaMasses"          "isotopeDotProduct"                  
## [19] "averageParentDeltaMass"              "lnSp"                                "maxLadderLength"                    
## [22] "deltaRT"                             "ms1MassError"                        "ms2MassError"                       
## [25] "numMissedCleavage"                   "pepLength"                           "charge1"                            
## [28] "charge2"                             "charge3"                             "charge4"                            
## [31] "precursorMz"                         "precursorMass"                       "RTinMin"                            
## [34] "sequence"                            "Proteins"                            "sample"                             
## [37] "group"
```

``` r
# all_decoy <- lapply(decoyFiles_fromEncyclopeDIA, function(f){
#   df <- readr::read_table(f)
#   source_file <- basename(f)
#   df$sample <- gsub("\\..*", "", source_file) 
#   # Add groups
#   df <- df %>% 
#     mutate(group = case_when(
#     str_detect(string = sample, pattern = "EV") ~ "WT",
#     str_detect(string = sample, pattern = "Parental") ~ "WT",
#     TRUE ~ "KO"
#   ))
#   return(df)
# }) %>% bind_rows()

# head(all_decoy)
# 
# all_feat$isDecoy <- "NO"
# all_decoy$isDecoy <- "YES"

# Combine 
#combined_df <- bind_rows(all_feat, all_decoy)

#table(combined_df$isDecoy)

# Clean the df
psm_data <- all_feat %>%
  #mutate(charge = pmax(charge1, charge2, charge3, charge4, na.rm = TRUE),
    #score = ifelse(is.na(HyperScore), xCorrLib, HyperScore)) %>%
   mutate(score = HyperScore, 
          charge = case_when(
            charge1 != 0 ~ 1, 
            charge2 != 0 ~ 2, 
            charge3 != 0 ~ 3, 
            TRUE ~ 4
          )) %>%
  filter(isIntegratedSignal == TRUE) %>% # keep only the rows from which encyclopeDIA could extract a signal
  # keep columns of interest
  dplyr::select(
    ScanNr,
    sequence,
    charge,
    score,
    precursorMz,
    rt = RTinMin,
    deltaRt = deltaRT,
    ms2Error = ms2MassError,
    score,
    protein = Proteins,
    sample,
    group
  ) %>% 
  rename(
    "spectrumID" = ScanNr,
    "accession" = protein, 
  ) %>% 
  mutate(isDecoy = case_when(
    str_detect(string = accession, pattern = "DECOY") ~ "TRUE", 
    TRUE ~ "FALSE"
  )) %>% 
  mutate(isDecoy = as.logical(isDecoy))

table(psm_data$isDecoy)
```

```
## 
##   FALSE    TRUE 
## 6832977 5837437
```


Plot score distribution before rank filtering

``` r
ggplot(psm_data, aes(x = score, fill = isDecoy))  +  
  scale_fill_manual(values = c("lightgray","#F59CA9")) +
  geom_histogram(alpha = 0.8) + 
  #scale_fill_manual(values = c("darkgreen")) +
  labs(title = "Score distribution by SpectrumID", x = "Score", y = "Density") + 
  theme_minimal() + 
  theme(aspect.ratio  = 1)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![plot of chunk unnamed-chunk-10](figure/unnamed-chunk-10-1.png)

Manually add rank 

``` r
psm_data_ranked <- psm_data %>%
  mutate(group = spectrumID) %>%
  group_by(group) %>%
  arrange(desc(score), .by_group = TRUE) %>%
  mutate(rank = row_number()) %>%
  ungroup()%>% 
  filter(rank == 1) # i.e. keep best scoring peptide match 
```

Remove multi-matching spectra (if present)

``` r
mltm <- psm_data_ranked %>%
  group_by(spectrumID) %>% 
  tally() %>%
  filter(n > 1) %>%
  pull(spectrumID)

cat("There are no multi-matching spectra")
```

```
## There are no multi-matching spectra
```

Score distribution after rank - filtering 

``` r
ggplot(psm_data_ranked, aes(x = score, fill = isDecoy))  + 
  scale_fill_manual(values = c("lightgray","#F59CA9")) +
  geom_histogram(alpha = 0.8) + 
  #scale_fill_manual(values = c("darkgreen")) +
  labs(title = "Score distribution by SpectrumID", x = "Score", y = "Density") + 
  theme_minimal() + 
  theme(aspect.ratio  = 1)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![plot of chunk unnamed-chunk-13](figure/unnamed-chunk-13-1.png)

Create the PSM object

``` r
psm_obj <- PSMatch::PSM(x = psm_data_ranked, 
                        spectrum = "spectrumID", peptide = "sequence",
           protein = "accession", decoy = "isDecoy", rank = "rank", score = "score")

psm_obj
```

```
## PSM with 126573 rows and 13 columns.
## names(13): spectrumID sequence ... isDecoy rank
```

``` r
names(psm_obj)
```

```
##  [1] "spectrumID"  "sequence"    "charge"      "score"       "precursorMz" "rt"          "deltaRt"     "ms2Error"   
##  [9] "accession"   "sample"      "group"       "isDecoy"     "rank"
```

N of decoy hits 

``` r
table(psm_obj$isDecoy)
```

```
## 
##  FALSE   TRUE 
## 103811  22762
```

``` r
# 
# cat("Decoy hits:", n_decoy, "\nTarget hits:", n_target)
```


``` r
psm_obj@metadata
```

```
## $variables
##     spectrum      peptide      protein        decoy         rank        score          fdr 
## "spectrumID"   "sequence"  "accession"    "isDecoy"       "rank"      "score"           NA
```

``` r
filt_psm = psm_obj %>% 
  filterPsmRank() %>% 
  filterPsmDecoy()
```

```
## Removed 0 PSMs with rank > 1.
```

```
## Removed 22762 decoy hits.
```

``` r
length(filt_psm$spectrumID)
```

```
## [1] 103811
```

``` r
# Total PSMs
n_total <- length(psm_obj$spectrumID)

# Target vs Decoy
is_decoy <- grepl("^DECOY", psm_obj$accession)  # adjust prefix if needed
n_decoy <- sum(is_decoy)
n_target <- n_total - n_decoy

# Unique peptides (sequence + charge)
peptide_df <- data.frame(
  peptide = filt_psm$sequence,
  charge = filt_psm$charge
) 
n_unique_peptides <- n_distinct(paste(peptide_df$peptide, peptide_df$charge, sep = "_"))

# Unique proteins
n_unique_proteins <- n_distinct(filt_psm$accession)

# Score summary
score_summary <- summary(filt_psm$score)
```



``` r
cat("PSM Object Summary\n")
```

```
## PSM Object Summary
```

``` r
cat("--------------------------\n")
```

```
## --------------------------
```

``` r
cat("Total PSMs:         ", n_total, "\n")
```

```
## Total PSMs:          126573
```

``` r
cat("Target PSMs:        ", n_target, "\n")
```

```
## Target PSMs:         103811
```

``` r
cat("Decoy PSMs:         ", n_decoy, "\n")
```

```
## Decoy PSMs:          22762
```

``` r
cat("Unique Peptides:    ", n_unique_peptides, "\n")
```

```
## Unique Peptides:     54114
```

``` r
cat("Unique Proteins:    ", n_unique_proteins, "\n\n")
```

```
## Unique Proteins:     13068
```

``` r
cat("Score Summary:\n")
```

```
## Score Summary:
```

``` r
print(score_summary)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   5.601   6.565   6.543   7.544  14.113
```

Adjacency matrix

``` r
adj <- makeAdjacencyMatrix(filt_psm, binary = F)

dim(adj)
```

```
## [1] 50617 13068
```

``` r
adj[1:5, 1:5]
```

```
## 5 x 5 sparse Matrix of class "dgCMatrix"
##                                                 sp|Q8VEE1|LMCD1_MOUSE sp|P22907|HEM3_MOUSE sp|Q6P560|ZN182_MOUSE
## -.DGAPWC[+57.0214635]GRHYC[+57.0214635]ESVRPR.-                     0                    .              .       
## -.SAVGTSSLRR.-                                                      .                    0              .       
## -.GLSLHQRIK.-                                                       .                    .              2.509495
## -.GDAENMVLC[+57.0214635]DGC[+57.0214635]DR.-                        .                    .              .       
## -.GPAPIIHTVLHGDTVTGVTIMQIRPKR.-                                     .                    .              .       
##                                                 sp|O88379|BAZ1A_MOUSE sp|Q9D799|FMT_MOUSE
## -.DGAPWC[+57.0214635]GRHYC[+57.0214635]ESVRPR.-              .                    .      
## -.SAVGTSSLRR.-                                               .                    .      
## -.GLSLHQRIK.-                                                .                    .      
## -.GDAENMVLC[+57.0214635]DGC[+57.0214635]DR.-                 2.984943             .      
## -.GPAPIIHTVLHGDTVTGVTIMQIRPKR.-                              .                    2.53558
```

Explore connected components

``` r
cc <- ConnectedComponents(adj)
length(cc)
```

```
## [1] 13068
```

``` r
cc
```

```
## An instance of class ConnectedComponents 
##  Number of proteins: 13068 
##  Number of components: 13068 
##  Number of components [peptide x proteins]:
##   4584[1 x 1] 0[1 x n] 8474[n x 1] 0[n x n]
```

``` r
connectedComponents(cc, 4)
```

```
## 1 x 1 sparse Matrix of class "dgCMatrix"
##                       sp|A0A0A6YXX9|CTSEL_MOUSE
## -.TFVLAWTKSEVYGGFGK.-                  6.465375
```

There are no protein groups identified by a single peptide 
8474 are single proteins identified by multiple unique peptides 

Protein groups (proteins that share the same peptide matches)

``` r
psm_data_ranked <- psm_data_ranked %>%
  ungroup() %>% 
  mutate(ProteinsList = str_split(accession, ";"),
         GroupKey     = sapply(ProteinsList, function(v) paste(sort(v), collapse=";")))

# How many PSMs with more than one protein 
multiProt <- grep(";", psm_data_ranked$accession)

cat("There are", length(multiProt), "protein groups in the data set")
```

```
## There are 5499 protein groups in the data set
```

``` r
#psm_filter$ProteinsList
```

Razor protein (the best supported by unique peptides)

``` r
pep2prot <- psm_data_ranked %>%
  select(sequence, ProteinsList) %>%
  tidyr::unnest(ProteinsList) %>%
  distinct()

# Count how many unique peptides for each protein
pep_counts <- pep2prot %>%
  group_by(sequence) %>%
  filter(n()==1) %>%           # keep only unique‐mapping peptides
  ungroup() %>%
  dplyr::count(ProteinsList, name="n_unique_peptides") %>% 
  as.data.frame()

razor_map <- pep_counts %>%
  inner_join(psm_data_ranked %>% select(GroupKey, ProteinsList) %>% distinct() %>% mutate(ProteinsList = as.character(ProteinsList)),
             by="ProteinsList") %>%
  group_by(GroupKey) %>%
  filter(n_unique_peptides == max(n_unique_peptides)) %>% # keep the row with more petides 
  slice(1) %>%  # in ties, just take the first
  ungroup() %>%
  select(GroupKey, RazorProtein=ProteinsList)
```

```
## Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'slice': Rle of type 'list' is not supported
```

``` r
# Merge back to psm object
psm_data_ranked = psm_data_ranked %>% 
  left_join(razor_map, by ="GroupKey")
```

```
## Error: object 'razor_map' not found
```

``` r
cat("Unique razor proteins:", length(unique(psm_data_ranked$RazorProtein)), "\n")
```

```
## Warning: Unknown or uninitialised column: `RazorProtein`.
```

```
## Unique razor proteins: 0
```

Peptide-level data processing, protein aggregation and DEA

Retrieve files exported from output.elib 

``` r
quant <- read_csv("~/Desktop/Proteomics/CapstoneProjectTeam1/peptidequants.csv")
```

```
## Rows: 355900 Columns: 22
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: ","
## chr  (8): PeptideModSeq, PeptideSeq, SourceFile, QuantIonMassArray, QuantIonIntensityArray, QuantIonCorrelationArray,...
## dbl (14): PrecursorCharge, RTInSecondsCenter, RTInSecondsStart, RTInSecondsStop, TotalIntensity, NumberOfQuantIons, Q...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
```

``` r
pep_to_prot <- read_csv("~/Desktop/Proteomics/CapstoneProjectTeam1/peptidetoprotein.csv")
```

```
## Rows: 38761 Columns: 3
## ── Column specification ─────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: ","
## chr (2): PeptideSeq, ProteinAccession
## dbl (1): isDecoy
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
```

``` r
# Filter out decoys keps in these files
pep_to_prot <- pep_to_prot %>% 
  filter(isDecoy == 0)

table(quant$SourceFile)
```

```
## 
##   bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml   bde18becba7_Tsiokas_111622_Sample_16_Clone7_expt1.mzml 
##                                                    35590                                                    35590 
##  bde2189b86_Tsiokas_111622_Sample_03_Parental_expt3.mzml   bde369cd20d_Tsiokas_111622_Sample_18_Clone7_expt3.mzml 
##                                                    35590                                                    35590 
##       bde3db9533d_Tsiokas_111622_Sample_06_EV_expt3.mzml    bde56fa718_Tsiokas_111622_Sample_08_Clone2_expt2.mzml 
##                                                    35590                                                    35590 
## bde5fc4a4df_Tsiokas_111622_Sample_01_Parental_expt1.mzml   bde65431b71_Tsiokas_111622_Sample_09_Clone2_expt3.mzml 
##                                                    35590                                                    35590 
## bde67245d97_Tsiokas_111622_Sample_02_Parental_expt2.mzml       bde6eb15ab1_Tsiokas_111622_Sample_05_EV_expt2.mzml 
##                                                    35590                                                    35590
```

``` r
# To check that all peptides identified in every sample
quant %>% 
  group_by(PeptideSeq) %>% 
  summarise(ndistfiles = n_distinct(SourceFile)) -> df

table(df$ndistfiles)
```

```
## 
##    10 
## 35590
```



``` r
# proteins
nest_prot <- pep_to_prot %>% 
  group_by(PeptideSeq) %>% 
  mutate(Proteins = paste0(ProteinAccession, collapse = ";")) %>% 
  select(-c("isDecoy", "ProteinAccession"))

# merge with peptide to protein 
quant_prot <- inner_join(quant, nest_prot, by = "PeptideSeq") %>% 
  filter(!is.na(Proteins))
```

```
## Warning in inner_join(quant, nest_prot, by = "PeptideSeq"): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 14 of `x` matches multiple rows in `y`.
## ℹ Row 22200 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship = "many-to-many"` to silence this warning.
```

``` r
table(quant_prot %>% duplicated())
```

```
## 
##  FALSE   TRUE 
## 338070  25280
```

``` r
# pivot wider
quant_wide <- quant_prot %>% 
  unique() %>% 
  pivot_wider(id_cols = c(PeptideSeq, Proteins), names_from = SourceFile, values_from = TotalIntensity)

head(quant_wide)
```

```
## # A tibble: 6 × 12
##   PeptideSeq         Proteins bde162c4da2_Tsiokas_…¹ bde18becba7_Tsiokas_…² bde2189b86_Tsiokas_1…³ bde369cd20d_Tsiokas_…⁴
##   <chr>              <chr>                     <dbl>                  <dbl>                  <dbl>                  <dbl>
## 1 TFAWLPGAPGVR       sp|O085…                9722062                264445.                     0                      0 
## 2 NEILQPSLQGPQTELR   sp|Q99J…                      0               3184000.                     0                      0 
## 3 DLVYILMAK          sp|Q80V…                      0                     0                      0                3074216.
## 4 VTIDPENNVISIWNNGK  sp|Q013…                      0                 63039.                     0                      0 
## 5 LGEFFQTK           sp|O088…                      0                     0                      0                      0 
## 6 EVQALIAEGIALVWESYK sp|Q9JH…                      0                300625.               1139274.                     0 
## # ℹ abbreviated names: ¹​bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml,
## #   ²​bde18becba7_Tsiokas_111622_Sample_16_Clone7_expt1.mzml, ³​bde2189b86_Tsiokas_111622_Sample_03_Parental_expt3.mzml,
## #   ⁴​bde369cd20d_Tsiokas_111622_Sample_18_Clone7_expt3.mzml
## # ℹ 6 more variables: bde3db9533d_Tsiokas_111622_Sample_06_EV_expt3.mzml <dbl>,
## #   bde56fa718_Tsiokas_111622_Sample_08_Clone2_expt2.mzml <dbl>,
## #   bde5fc4a4df_Tsiokas_111622_Sample_01_Parental_expt1.mzml <dbl>,
## #   bde65431b71_Tsiokas_111622_Sample_09_Clone2_expt3.mzml <dbl>, …
```

``` r
psm_se <- readQFeatures(quant_wide,
                        quantCols = colnames(quant_wide)[3:12],
                        fnames = "PeptideSeq", 
                        name = "peptides")
```

```
## Checking arguments.
```

```
## Loading data as a 'SummarizedExperiment' object.
```

```
## Formatting sample annotations (colData).
```

```
## Formatting data as a 'QFeatures' object.
```

```
## Setting assay rownames.
```

``` r
psm_se <- QFeatures::zeroIsNA(psm_se, i = "peptides") # zeroes sho
nna = nNA(psm_se, 1)
```


``` r
nna
```

```
## $nNA
## DataFrame with 1 row and 3 columns
##         assay       nNA       pNA
##   <character> <integer> <numeric>
## 1    peptides    151858  0.449191
## 
## $nNArows
## DataFrame with 33807 rows and 4 columns
##             assay          name       nNA       pNA
##       <character>   <character> <integer> <numeric>
## 1        peptides TFAWLPGAPG...         3       0.3
## 2        peptides NEILQPSLQG...         6       0.6
## 3        peptides     DLVYILMAK         9       0.9
## 4        peptides VTIDPENNVI...         6       0.6
## 5        peptides      LGEFFQTK         9       0.9
## ...           ...           ...       ...       ...
## 33803    peptides     DLLQFFKPR         2       0.2
## 33804    peptides MQEVYNFNAI...         8       0.8
## 33805    peptides QLHELAPSIF...         7       0.7
## 33806    peptides APKPDGPGGG...         0       0.0
## 33807    peptides YMPQNPHIIA...         3       0.3
## 
## $nNAcols
## DataFrame with 10 rows and 4 columns
##          assay          name       nNA       pNA
##    <character>   <character> <integer> <numeric>
## 1     peptides bde162c4da...     15419  0.456089
## 2     peptides bde18becba...     14260  0.421806
## 3     peptides bde2189b86...     15258  0.451327
## 4     peptides bde369cd20...     14778  0.437128
## 5     peptides bde3db9533...     14518  0.429438
## 6     peptides bde56fa718...     18562  0.549058
## 7     peptides bde5fc4a4d...     14723  0.435502
## 8     peptides bde65431b7...     14781  0.437217
## 9     peptides bde67245d9...     14584  0.431390
## 10    peptides bde6eb15ab...     14975  0.442956
```


``` r
#rm(psm_se_filtered)
psm_se_filtered = filterNA(psm_se, 0.2, i=1) # kept every peptide with less than 20% missing data

nna = nNA(psm_se_filtered, 1)
nna
```

```
## $nNA
## DataFrame with 1 row and 3 columns
##         assay       nNA       pNA
##   <character> <integer> <numeric>
## 1    peptides      9529 0.0774338
## 
## $nNArows
## DataFrame with 12306 rows and 4 columns
##             assay          name       nNA       pNA
##       <character>   <character> <integer> <numeric>
## 1        peptides GLGEHEMDED...         0       0.0
## 2        peptides     LLGLLMPFR         1       0.1
## 3        peptides      MVLVGDVK         0       0.0
## 4        peptides GEEIVQQLIE...         2       0.2
## 5        peptides TSFVNFTDIC...         2       0.2
## ...           ...           ...       ...       ...
## 12302    peptides LLQSVGQAPE...         2       0.2
## 12303    peptides QEQIINTMTQ...         1       0.1
## 12304    peptides SNEDQSMGNW...         0       0.0
## 12305    peptides     DLLQFFKPR         2       0.2
## 12306    peptides APKPDGPGGG...         0       0.0
## 
## $nNAcols
## DataFrame with 10 rows and 4 columns
##          assay          name       nNA       pNA
##    <character>   <character> <integer> <numeric>
## 1     peptides bde162c4da...       881 0.0715911
## 2     peptides bde18becba...       502 0.0407931
## 3     peptides bde2189b86...       877 0.0712660
## 4     peptides bde369cd20...       636 0.0516821
## 5     peptides bde3db9533...       547 0.0444499
## 6     peptides bde56fa718...      3443 0.2797822
## 7     peptides bde5fc4a4d...       635 0.0516008
## 8     peptides bde65431b7...       665 0.0540387
## 9     peptides bde67245d9...       591 0.0480254
## 10    peptides bde6eb15ab...       752 0.0611084
```


``` r
## Norm
# First impute missing data
psm_se_filtered <- QFeatures::impute(psm_se_filtered, method = "knn", i = "peptides", name = "imputed_peptides")
```

```
## Imputing along margin 1 (features/rows).
```

```
## Cluster size 12306 broken into 241 12065 
## Done cluster 241 
## Cluster size 12065 broken into 11194 871 
## Cluster size 11194 broken into 2024 9170 
## Cluster size 2024 broken into 667 1357 
## Done cluster 667 
## Done cluster 1357 
## Done cluster 2024 
## Cluster size 9170 broken into 6439 2731 
## Cluster size 6439 broken into 2510 3929 
## Cluster size 2510 broken into 2403 107 
## Cluster size 2403 broken into 769 1634 
## Done cluster 769 
## Cluster size 1634 broken into 1017 617 
## Done cluster 1017 
## Done cluster 617 
## Done cluster 1634 
## Done cluster 2403 
## Done cluster 107 
## Done cluster 2510 
## Cluster size 3929 broken into 2178 1751 
## Cluster size 2178 broken into 1011 1167 
## Done cluster 1011 
## Done cluster 1167 
## Done cluster 2178 
## Cluster size 1751 broken into 579 1172 
## Done cluster 579 
## Done cluster 1172 
## Done cluster 1751 
## Done cluster 3929 
## Done cluster 6439 
## Cluster size 2731 broken into 154 2577 
## Done cluster 154 
## Cluster size 2577 broken into 994 1583 
## Done cluster 994 
## Cluster size 1583 broken into 672 911 
## Done cluster 672 
## Done cluster 911 
## Done cluster 1583 
## Done cluster 2577 
## Done cluster 2731 
## Done cluster 9170 
## Done cluster 11194 
## Done cluster 871 
## Done cluster 12065
```

``` r
# log2 transform
psm_se_filtered <- logTransform(psm_se_filtered, base = 2, i = "imputed_peptides", name = "log_peptides")


assay(psm_se_filtered, i = "log_peptides") %>% 
  as.data.frame() %>% 
  pivot_longer(cols = everything(), names_to = "File", values_to = "Intensity") -> t_psm

ggplot(t_psm, aes(x = as.factor(File), y = Intensity, fill = "File")) + 
  scale_fill_manual(values = "#C0E0DE") + 
  geom_boxplot(outliers = T) + 
  theme_minimal() + 
  theme(aspect.ratio = 1,
        axis.text.x = element_blank(),
        legend.position ="none") + 
  xlab("") -> g_before
limma::plotDensities(assay(psm_se_filtered[["log_peptides"]]))
```

![plot of chunk unnamed-chunk-27](figure/unnamed-chunk-27-1.png)

``` r
# Check different norm methods 
psm_se_filtered <- QFeatures::normalize(psm_se_filtered, method = "center.median", i = "log_peptides", name = "norm_center_median_log")
psm_se_filtered <- QFeatures::normalize(psm_se_filtered, method = "center.mean", i = "log_peptides", name = "norm_center_mean_log")

psm_se_filtered <- QFeatures::normalize(psm_se_filtered, method = "vsn", i = "peptides", name = "norm_vsn")
```

```
## vsn2: 12306 x 10 matrix (1 stratum).
```

```
## Please use 'meanSdPlot' to verify the fit.
```

``` r
assay(psm_se_filtered, i = "norm_center_median_log") %>% 
  as.data.frame() %>% 
  pivot_longer(cols = everything(), names_to = "File", values_to = "Intensity") -> t_psm_median

assay(psm_se_filtered, i = "norm_center_mean_log") %>% 
  as.data.frame() %>% 
  pivot_longer(cols = everything(), names_to = "File", values_to = "Intensity") -> t_psm_mean

assay(psm_se_filtered, i = "norm_vsn") %>% 
  as.data.frame() %>% 
  pivot_longer(cols = everything(), names_to = "File", values_to = "Intensity") -> t_psm_vsn

ggplot(t_psm_median, aes(x = as.factor(File), y = Intensity, fill = "File")) + 
  scale_fill_manual(values = "#C0E0DE") + 
  geom_boxplot(outliers = T) + 
  theme_minimal() + 
  theme(aspect.ratio = 1,
        axis.text.x = element_blank(),
        legend.position ="none") + 
  xlab("") -> g_median

ggplot(t_psm_mean, aes(x = as.factor(File), y = Intensity, fill = "File")) + 
  scale_fill_manual(values = "#C0E0DE") + 
  geom_boxplot(outliers = T) + 
  theme_minimal() + 
  theme(aspect.ratio = 1,
        axis.text.x = element_blank(),
        legend.position ="none") + 
  xlab("")-> g_mean

ggplot(t_psm_vsn, aes(x = as.factor(File), y = Intensity, fill = "File")) + 
  scale_fill_manual(values = "#C0E0DE") + 
  geom_boxplot(outliers = T) + 
  theme_minimal() + 
  theme(aspect.ratio = 1,
        axis.text.x = element_blank(),
        legend.position = element_blank()) + 
  xlab("") -> g_vsn

#pdf("../../../../CapstoneProjectTeam1/norm_plots.pdf", height = 4, width = 10)
ggarrange(g_before, g_mean , g_median, ncol = 3) # keep median
```

![plot of chunk unnamed-chunk-27](figure/unnamed-chunk-27-2.png)

``` r
#dev.off()

# Protein aggrgation on normalised peptides 
qf_prot <- aggregateFeatures(
  object = psm_se_filtered,
  i     = "norm_center_median_log",     # aggregate the peptide assay
  fcol  = "Proteins",    
  name  = "proteins",     # name for the new protein-level assay
  fun   = MsCoreUtils::robustSummary
)

limma::plotDensities(assay(qf_prot[["peptides"]]), legen =F)
```

![plot of chunk unnamed-chunk-27](figure/unnamed-chunk-27-3.png)


``` r
head(assay(qf_prot[["proteins"]]))
```

```
##                                             bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                   -0.2863225
## sp|A2A432|CUL4B_MOUSE                                                                   -1.0497363
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.5916327
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3610367
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              -6.0349730
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.7125590
##                                             bde18becba7_Tsiokas_111622_Sample_16_Clone7_expt1.mzml
## sp|A1L317|K1C24_MOUSE                                                                    0.9088852
## sp|A2A432|CUL4B_MOUSE                                                                   -1.4146786
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.3097026
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.4880792
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                               2.0234628
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.6601619
##                                             bde2189b86_Tsiokas_111622_Sample_03_Parental_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                    -0.6481754
## sp|A2A432|CUL4B_MOUSE                                                                    -1.4544009
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                              -0.9752463
## sp|A2A4P0|DHX8_MOUSE                                                                     -2.4954285
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                1.3651629
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                -2.2696677
##                                             bde369cd20d_Tsiokas_111622_Sample_18_Clone7_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                    0.6160671
## sp|A2A432|CUL4B_MOUSE                                                                   -1.4441663
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.1783013
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3756112
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              -0.3036535
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.4265484
##                                             bde3db9533d_Tsiokas_111622_Sample_06_EV_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                               -0.5002398
## sp|A2A432|CUL4B_MOUSE                                                               -1.3442156
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                         -0.7767714
## sp|A2A4P0|DHX8_MOUSE                                                                -2.2641094
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                           1.2294788
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                           -1.6749867
##                                             bde56fa718_Tsiokas_111622_Sample_08_Clone2_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                   0.4034933
## sp|A2A432|CUL4B_MOUSE                                                                  -1.0485485
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                            -3.1077194
## sp|A2A4P0|DHX8_MOUSE                                                                   -3.4163402
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              1.7283768
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                              -3.1063908
##                                             bde5fc4a4df_Tsiokas_111622_Sample_01_Parental_expt1.mzml
## sp|A1L317|K1C24_MOUSE                                                                      -5.673442
## sp|A2A432|CUL4B_MOUSE                                                                      -2.033351
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                                -3.169445
## sp|A2A4P0|DHX8_MOUSE                                                                       -2.387935
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                  1.246676
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                  -1.825352
##                                             bde65431b71_Tsiokas_111622_Sample_09_Clone2_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                   -0.3639332
## sp|A2A432|CUL4B_MOUSE                                                                   -1.3701379
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.4905719
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3302395
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                               2.0120427
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -2.3131625
##                                             bde67245d97_Tsiokas_111622_Sample_02_Parental_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                      -0.292634
## sp|A2A432|CUL4B_MOUSE                                                                      -2.058052
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                                -2.133669
## sp|A2A4P0|DHX8_MOUSE                                                                       -2.285788
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                  1.566669
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                  -2.451962
##                                             bde6eb15ab1_Tsiokas_111622_Sample_05_EV_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                               -0.7872873
## sp|A2A432|CUL4B_MOUSE                                                               -1.5095321
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                         -2.3197532
## sp|A2A4P0|DHX8_MOUSE                                                                -2.5902906
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                           2.0147316
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                           -2.4257966
```



``` r
# extract protein matrix
prot_mat <- assay(qf_prot, "proteins")  
head(prot_mat)
```

```
##                                             bde162c4da2_Tsiokas_111622_Sample_17_Clone7_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                   -0.2863225
## sp|A2A432|CUL4B_MOUSE                                                                   -1.0497363
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.5916327
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3610367
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              -6.0349730
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.7125590
##                                             bde18becba7_Tsiokas_111622_Sample_16_Clone7_expt1.mzml
## sp|A1L317|K1C24_MOUSE                                                                    0.9088852
## sp|A2A432|CUL4B_MOUSE                                                                   -1.4146786
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.3097026
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.4880792
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                               2.0234628
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.6601619
##                                             bde2189b86_Tsiokas_111622_Sample_03_Parental_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                    -0.6481754
## sp|A2A432|CUL4B_MOUSE                                                                    -1.4544009
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                              -0.9752463
## sp|A2A4P0|DHX8_MOUSE                                                                     -2.4954285
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                1.3651629
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                -2.2696677
##                                             bde369cd20d_Tsiokas_111622_Sample_18_Clone7_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                    0.6160671
## sp|A2A432|CUL4B_MOUSE                                                                   -1.4441663
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.1783013
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3756112
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              -0.3036535
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -1.4265484
##                                             bde3db9533d_Tsiokas_111622_Sample_06_EV_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                               -0.5002398
## sp|A2A432|CUL4B_MOUSE                                                               -1.3442156
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                         -0.7767714
## sp|A2A4P0|DHX8_MOUSE                                                                -2.2641094
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                           1.2294788
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                           -1.6749867
##                                             bde56fa718_Tsiokas_111622_Sample_08_Clone2_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                   0.4034933
## sp|A2A432|CUL4B_MOUSE                                                                  -1.0485485
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                            -3.1077194
## sp|A2A4P0|DHX8_MOUSE                                                                   -3.4163402
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              1.7283768
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                              -3.1063908
##                                             bde5fc4a4df_Tsiokas_111622_Sample_01_Parental_expt1.mzml
## sp|A1L317|K1C24_MOUSE                                                                      -5.673442
## sp|A2A432|CUL4B_MOUSE                                                                      -2.033351
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                                -3.169445
## sp|A2A4P0|DHX8_MOUSE                                                                       -2.387935
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                  1.246676
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                  -1.825352
##                                             bde65431b71_Tsiokas_111622_Sample_09_Clone2_expt3.mzml
## sp|A1L317|K1C24_MOUSE                                                                   -0.3639332
## sp|A2A432|CUL4B_MOUSE                                                                   -1.3701379
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                             -1.4905719
## sp|A2A4P0|DHX8_MOUSE                                                                    -2.3302395
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                               2.0120427
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                               -2.3131625
##                                             bde67245d97_Tsiokas_111622_Sample_02_Parental_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                                      -0.292634
## sp|A2A432|CUL4B_MOUSE                                                                      -2.058052
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                                -2.133669
## sp|A2A4P0|DHX8_MOUSE                                                                       -2.285788
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                                  1.566669
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                                  -2.451962
##                                             bde6eb15ab1_Tsiokas_111622_Sample_05_EV_expt2.mzml
## sp|A1L317|K1C24_MOUSE                                                               -0.7872873
## sp|A2A432|CUL4B_MOUSE                                                               -1.5095321
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                         -2.3197532
## sp|A2A4P0|DHX8_MOUSE                                                                -2.5902906
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                           2.0147316
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                           -2.4257966
```

Generate a condition table for each sample

``` r
samples <- colnames(assay(qf_prot))

conditions <- data.frame(c(samples), "")

colnames(conditions) <- c("SourceFile", "condition")
 
conditions <- conditions %>% 
  mutate(condition = case_when(
    str_detect(string = samples, pattern = "EV") ~ "WT",
    str_detect(string = samples, pattern = "Parental") ~ "WT",
    TRUE ~ "KO"
  )) %>% 
  column_to_rownames(var ="SourceFile")

table(conditions)
```

```
## condition
## KO WT 
##  5  5
```


``` r
colData(qf_prot) <- conditions
```

DE analysis

``` r
#pdf("norm_center_median_log_densities.pdf", height = 5, width = 5)
limma::plotDensities(assay(qf_prot[["norm_center_median_log"]]), legend = F)
```

![plot of chunk unnamed-chunk-32](figure/unnamed-chunk-32-1.png)

``` r
#dev.off()
```

Plot multidimensional summary

``` r
colors <- case_when(
    str_detect(string = rownames(conditions), pattern = "EV") ~ "black",
    str_detect(string = rownames(conditions), pattern = "Parental") ~ "gray",
    TRUE ~ "red"
  )

#pdf("mds_pep.pdf", height = 6, width = 6)
limma::plotMDS(assay(qf_prot[["norm_center_median_log"]]), col=colors)
```

![plot of chunk unnamed-chunk-33](figure/unnamed-chunk-33-1.png)

``` r
#dev.off()
```

Plot PCA results

``` r
pca_prot <-
    qf_prot[["proteins"]] %>%
    filterNA() %>%
    assay() %>%
    t() %>%
    prcomp(scale = TRUE, center = TRUE) %>%
    fviz_pca_ind(habillage = qf_prot$condition,
                 title = "Proteins (robustSummary aggregation)",palette = c("#8DDCA4", "#413C58"))

#pdf("pca_proteins.pdf", height = 6, width = 6)
pca_prot
```

![plot of chunk unnamed-chunk-34](figure/unnamed-chunk-34-1.png)

``` r
#dev.off()
```


``` r
#pdf("mds_prot.pdf", height = 6, width = 6)
limma::plotMDS(assay(qf_prot[["proteins"]]), col = colors)
```

![plot of chunk unnamed-chunk-35](figure/unnamed-chunk-35-1.png)

``` r
#dev.off()
```


``` r
qf_prot <- msqrob(object = qf_prot, i = "proteins", formula = ~condition, overwrite =T)
```


``` r
getCoef(rowData(qf_prot[["proteins"]])$msqrobModels[[1]])
```

```
## (Intercept) conditionWT 
##    0.255638   -1.226878
```

``` r
# Create contrasts
L <- makeContrast("conditionWT=0", parameterNames = c("conditionWT"))

qf_prot <- msqrob2::hypothesisTest(object = qf_prot, i = "proteins", contrast = L, overwrite =T)
```

Create volcano plot

``` r
volcano <- ggplot(
    rowData(qf_prot[["proteins"]])$conditionWT,
    aes(x = logFC, y = -log10(pval), color = adjPval < 0.05)
) +
    geom_point(cex = 2.5) +
    scale_color_manual(values = alpha(c("black", "red"), 0.5)) +
    theme_minimal() + 
    theme(aspect.ratio = 1)

pdf("vp_WTvsKO.pdf", height = 5, width = 5)
volcano
dev.off()
```

```
## quartz_off_screen 
##                 2
```

Try to locate TMEM237 (https://www.uniprot.org/uniprotkb/Q3V0J1/entry)

``` r
res_df <- rowData(qf_prot[["proteins"]])$conditionWT

res_df
```

```
##                                                                                               logFC        se        df
## sp|A1L317|K1C24_MOUSE                                                                  -1.226877930 0.6915186  9.352665
## sp|A2A432|CUL4B_MOUSE                                                                  -0.414456904 0.2153591 10.000357
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                            -0.176367905 0.5167510  9.410047
## sp|A2A4P0|DHX8_MOUSE                                                                    0.076514103 0.2145295  9.395957
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              0.998434180 0.9148943  7.291556
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                              -0.174868353 0.3237030  9.613626
## sp|A2A6A1|GPTC8_MOUSE                                                                  -0.009879512 0.5079730  9.852999
## sp|A2A8U2|TM201_MOUSE                                                                  -2.409798477 1.7850936  9.542383
## sp|A2A8Z1|OSBL9_MOUSE                                                                   0.131199065 0.2612877  9.678387
## sp|A2A9C3|SZT2_MOUSE                                                                    0.749228231 0.2179461  9.695570
## sp|A2ABV5|MED14_MOUSE                                                                  -0.576262213 0.4006035  9.543786
## sp|A2AGH6|MED12_MOUSE;sp|Q8BJR6|PRS27_MOUSE                                            -0.653464887 0.4297294  9.184134
## sp|A2AGH6|MED12_MOUSE;sp|Q8BQM9|MD12L_MOUSE                                            -0.498806163 0.8365659  9.055280
## sp|A2AGT5|CKAP5_MOUSE                                                                  -0.332708783 0.3485696  9.471253
## sp|A2AIV2|VIR_MOUSE                                                                    -0.896086589 0.7796500  8.122568
## sp|A2AJ15|MA1B1_MOUSE                                                                  -0.089548402 0.2353552  9.156274
## sp|A2AN08|UBR4_MOUSE                                                                    0.707336710 0.3229632 10.000357
## sp|A2APB8|TPX2_MOUSE                                                                   -0.083046007 0.3294417  9.206757
## sp|A2AQ19|RTF1_MOUSE                                                                   -0.027969390 0.5416906  8.227817
## sp|A2AR02|PPIG_MOUSE                                                                   -0.524686242 0.3055186  9.249826
## sp|A2ARP1|VIP1_MOUSE;sp|Q6ZQB6|VIP2_MOUSE                                              -0.794714433 0.9952272  8.746314
## sp|A2ASQ1|AGRIN_MOUSE                                                                  -2.580084944 1.8468698  9.815147
## sp|A2BE28|LAS1L_MOUSE                                                                  -1.529924772 0.7262352  8.956687
## sp|A2BH40|ARI1A_MOUSE                                                                  -0.018854199 0.3839851 10.000357
## sp|A2RSY1|KANL3_MOUSE                                                                  -0.271951466 0.7132451 10.000357
## sp|A2RTL5|RSRC2_MOUSE                                                                  -0.346841233 0.5394326 10.000357
## sp|A2TJV2|PALM3_MOUSE                                                                  -2.431130714 1.0053473  9.367712
## sp|A3KFU9|DISP3_MOUSE                                                                  -0.074395188 0.4251385  9.138738
## sp|A6H6E9|TT23L_MOUSE                                                                   0.790047462 0.2531571  9.594724
## sp|A6PWY4|WDR76_MOUSE                                                                   1.306944773 1.3152635  9.185150
## sp|B1ARD6|SLFN9_MOUSE                                                                   1.602231937 1.2382110  9.449733
## sp|B1AVY7|KI16B_MOUSE                                                                   1.008755931 0.4265837  7.989611
## sp|B1AVZ0|UPP_MOUSE                                                                     0.856788961 1.9531531  9.484894
## sp|B1AZI6|THOC2_MOUSE                                                                  -0.547822644 0.2270394  9.582223
## sp|B1AZP2|DLGP4_MOUSE                                                                  -0.243908219 0.2324234  9.940199
## sp|B2RQC6|PYR1_MOUSE                                                                   -0.292715789 0.2847669  8.710821
## sp|B2RXS4|PLXB2_MOUSE                                                                   0.051503568 0.1999730  9.610950
## sp|B2RY56|RBM25_MOUSE                                                                  -0.286710529 0.2174834 10.000357
## sp|B7ZMP1|XPP3_MOUSE                                                                   -0.309351306 0.3025935  9.528928
## sp|B9EJ80|PDZD8_MOUSE                                                                  -1.394427198 0.5780719  9.785683
## sp|B9EJ86|OSBL8_MOUSE                                                                  -0.234741259 0.3496529  9.736801
## sp|B9EJR8|DAAF5_MOUSE                                                                  -0.524976774 1.6062499  9.477833
## sp|C0HKD9|MFA1B_MOUSE;sp|C0HKD8|MFA1A_MOUSE                                            -0.961723465 0.5690509  9.392278
## sp|C0HKG5|RNT2A_MOUSE;sp|C0HKG6|RNT2B_MOUSE                                             0.217793343 0.6951240  7.955569
## sp|D3YXK1|SAMD1_MOUSE                                                                   0.566274796 1.1492701  9.313671
## sp|D3YXK2|SAFB1_MOUSE                                                                   0.785450447 0.6127209  9.256428
## sp|D3YXK2|SAFB1_MOUSE;sp|Q80YR5|SAFB2_MOUSE                                            -0.063651173 0.3912928 10.000357
## sp|D3YZP9|CCDC6_MOUSE                                                                  -1.680475861 0.8736970  8.907424
## sp|D3Z2R5|SELN_MOUSE                                                                   -0.112446440 0.6556727  9.604323
## sp|D3Z7P3|GLSK_MOUSE                                                                   -0.894334195 0.4898282  9.328693
## sp|E2JF22|PIEZ1_MOUSE                                                                   0.347570258 0.7809926  8.729455
## sp|E9PVA8|GCN1_MOUSE                                                                   -0.406628792 0.3704583  9.115532
## sp|E9PVX6|KI67_MOUSE                                                                    0.230015304 0.3019166  9.191233
## sp|E9PZJ8|ASCC3_MOUSE                                                                   0.082377616 0.2834589  9.380526
## sp|E9Q4N7|ARI1B_MOUSE                                                                  -0.090931045 1.0872193  9.563505
## sp|E9Q4Z2|ACACB_MOUSE;sp|Q5SWU9|ACACA_MOUSE                                             0.874366887 0.4941410  9.083713
## sp|E9Q555|RN213_MOUSE                                                                   1.775868973 0.3406402  8.755276
## sp|E9Q557|DESP_MOUSE                                                                    1.073962166 0.3882334  9.513730
## sp|E9Q5C9|NOLC1_MOUSE                                                                  -0.227805184 0.1987900  8.666856
## sp|E9Q5G3|KIF23_MOUSE                                                                   0.299748604 0.2708484  9.236360
## sp|E9Q6J5|BD1L1_MOUSE                                                                  -1.061351455 0.5939474  9.653501
## sp|E9Q784|ZC3HD_MOUSE                                                                  -4.757345556 2.0616658 10.000357
## sp|E9Q7E2|ARID2_MOUSE                                                                   0.014713273 0.4492237  9.625590
## sp|E9Q7G0|NUMA1_MOUSE                                                                   0.186697263 0.3131960  9.924322
## sp|F6ZDS4|TPR_MOUSE                                                                    -0.287281299 0.1773703  9.448217
## sp|F7BJB9|MORC3_MOUSE                                                                   0.974351160 0.2893143  9.305019
## sp|F8VPU2|FARP1_MOUSE                                                                  -0.273253879 0.2392740 10.000357
## sp|G5E829|AT2B1_MOUSE                                                                  -0.154096964 0.3515867  9.616135
## sp|G5E870|TRIPC_MOUSE                                                                  -0.231839551 0.1927940  9.637338
## sp|G5E897|PLGT3_MOUSE                                                                  -1.429807188 0.8102484  9.793525
## sp|G5E8K5|ANK3_MOUSE                                                                   -0.563004356 0.5640064  8.941737
## sp|O08528|HXK2_MOUSE                                                                   -0.752151153 0.3030445  9.671227
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE                                              -0.006141225 0.2377756  9.471763
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE;sp|Q3TRM8|HXK3_MOUSE                         -0.177327299 0.7475913  9.575863
## sp|O08529|CAN2_MOUSE                                                                   -0.256568489 0.5159238  9.749635
## sp|O08539|BIN1_MOUSE                                                                   -2.004785974 0.9258343  9.803394
## sp|O08547|SC22B_MOUSE                                                                   0.676482599 0.3579359  9.618104
## sp|O08553|DPYL2_MOUSE                                                                   0.039871063 0.2420141  9.295385
## sp|O08579|EMD_MOUSE                                                                    -0.721462166 0.6298485  9.395241
## sp|O08582|GTPB1_MOUSE                                                                   1.271008395 0.5271321  9.415419
## sp|O08583|THOC4_MOUSE                                                                  -0.279073496 0.6868726  9.448397
## sp|O08583|THOC4_MOUSE;sp|Q9JJW6|ALRF2_MOUSE                                            -0.087209228 0.2843655  9.621142
## sp|O08585|CLCA_MOUSE                                                                   -0.100740944 0.6324481  9.175490
## sp|O08600|NUCG_MOUSE                                                                   -1.880543522 2.0222907  9.618209
## sp|O08601|MTP_MOUSE                                                                     0.575763398 1.5201647  9.476896
## sp|O08638|MYH11_MOUSE;sp|Q61879|MYH10_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE -0.227079984 0.5367680 10.000357
## sp|O08638|MYH11_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE                        0.953189771 0.4153404  9.090563
## sp|O08638|MYH11_MOUSE;sp|Q8VDD5|MYH9_MOUSE                                              0.972973955 0.2589472  9.439073
## sp|O08663|MAP2_MOUSE                                                                    1.153744651 0.2957943  9.267848
## sp|O08709|PRDX6_MOUSE                                                                   0.222337722 0.3513773 10.000357
## sp|O08740|RPB11_MOUSE                                                                  -0.880916657 0.9474611  9.860624
## sp|O08749|DLDH_MOUSE                                                                   -0.554046821 0.2626769  9.803285
## sp|O08756|HCD2_MOUSE                                                                   -0.583973417 0.2757017 10.000357
## sp|O08784|TCOF_MOUSE                                                                   -0.488884298 0.2904429  8.880958
## sp|O08788|DCTN1_MOUSE                                                                   0.938648747 0.2059997 10.000357
## sp|O08795|GLU2B_MOUSE                                                                  -0.220957651 0.2900787  9.339299
## sp|O08807|PRDX4_MOUSE                                                                   0.217932688 0.4146370 10.000357
## sp|O08808|DIAP1_MOUSE                                                                   0.733779585 0.8013000  9.650228
## sp|O08810|U5S1_MOUSE                                                                   -0.070360304 0.1716903  9.559534
## sp|O08848|RO60_MOUSE                                                                   -1.470844483 0.4435240  8.804314
## sp|O08856|ELL_MOUSE                                                                     0.469796586 0.8524029  9.396353
## sp|O08915|AIP_MOUSE                                                                     0.094266078 0.2895465  8.575837
## sp|O08917|FLOT1_MOUSE                                                                  -0.235277375 0.6357991  9.010971
## sp|O08967|CYH3_MOUSE;sp|P63034|CYH2_MOUSE;sp|Q9QX11|CYH1_MOUSE                         -0.477512340 0.4385597  8.940025
## sp|O09005|DEGS1_MOUSE                                                                  -0.422780732 0.3658495 10.000357
## sp|O09044|SNP23_MOUSE                                                                  -1.126475543 0.3683941 10.000357
## sp|O09061|PSB1_MOUSE                                                                    0.500944259 0.2249015 10.000357
## sp|O09106|HDAC1_MOUSE                                                                  -0.672684142 0.6736197  8.974258
## sp|O09106|HDAC1_MOUSE;sp|P70288|HDAC2_MOUSE                                            -0.054934850 0.3662362  9.380665
## sp|O09111|NDUBB_MOUSE                                                                   0.233672798 0.4460951 10.000357
## sp|O09117|SYPL1_MOUSE                                                                  -0.874123277 0.4671317  9.638704
## sp|O09131|GSTO1_MOUSE                                                                   0.274728521 0.6465637  9.153423
## sp|O09131|GSTO1_MOUSE;sp|Q8K2Q2|GSTO2_MOUSE                                             0.551230184 0.5782129  9.392290
## sp|O09167|RL21_MOUSE                                                                    0.198958105 0.3374216  9.453777
## sp|O09172|GSH0_MOUSE                                                                    2.627971094 0.6168951  8.898201
## sp|O35054|CLD4_MOUSE                                                                   -1.575593638 1.2997085  9.584307
## sp|O35114|SCRB2_MOUSE                                                                  -0.911613591 0.7322377  9.716535
## sp|O35127|C10_MOUSE                                                                    -0.996777933 0.9272148  9.183466
## sp|O35129|PHB2_MOUSE                                                                   -0.202616000 0.2741584  9.386200
## sp|O35130|NEP1_MOUSE                                                                    0.507980096 0.6695093  9.062324
## sp|O35134|RPA1_MOUSE                                                                   -0.550722509 0.2724543 10.000357
## sp|O35144|TERF2_MOUSE                                                                  -0.430007265 0.8590323  9.036466
## sp|O35166|GOSR2_MOUSE                                                                   0.327184355 0.2977156 10.000357
## sp|O35207|CDKA1_MOUSE                                                                  -0.242332153 0.3558303  9.640422
## sp|O35218|CPSF2_MOUSE                                                                   0.303793270 0.4112772  8.204550
## sp|O35226|PSMD4_MOUSE                                                                   0.271817492 0.5962432  9.773509
## sp|O35245|PKD2_MOUSE                                                                   -0.165504738 0.6236816  9.369631
## sp|O35250|EXOC7_MOUSE                                                                  -2.653046294 1.4900254  9.290927
## sp|O35286|DHX15_MOUSE                                                                  -0.325039513 0.1649071  9.832502
## sp|O35295|PURB_MOUSE                                                                   -0.184695928 0.6440296  9.132145
## sp|O35316|SC6A6_MOUSE                                                                  -0.017002228 0.6766451  9.305312
## sp|O35326|SRSF5_MOUSE                                                                  -0.519555126 0.2032196  9.717228
## sp|O35343|IMA3_MOUSE                                                                    0.313750139 0.5078122  9.844844
## sp|O35344|IMA4_MOUSE                                                                   -0.468767367 0.2333936  8.953165
## sp|O35345|IMA7_MOUSE                                                                    1.770081096 1.1295442  7.441957
## sp|O35350|CAN1_MOUSE                                                                    0.582020476 0.3880714  9.990044
## sp|O35379|MRP1_MOUSE                                                                    0.364826458 0.2892051  8.780284
## sp|O35381|AN32A_MOUSE                                                                   0.068858097 0.2773897  9.239082
## sp|O35382|EXOC4_MOUSE                                                                   0.068640672 0.6110923  9.431680
## sp|O35387|HAX1_MOUSE                                                                    0.537967808 0.4799822  9.153415
## sp|O35427|RPC9_MOUSE                                                                   -0.836426359 1.4098427  8.723424
## sp|O35435|PYRD_MOUSE                                                                   -1.145725561 0.3438078  9.662242
## sp|O35465|FKBP8_MOUSE                                                                  -0.234944727 0.1776738 10.000357
## sp|O35516|NOTC2_MOUSE                                                                   1.844981762 0.6430428  7.557727
## sp|O35566|CD151_MOUSE                                                                   0.251591200 0.6904811 10.000357
## sp|O35593|PSDE_MOUSE                                                                    0.522701204 0.2053193  9.833461
## sp|O35609|SCAM3_MOUSE                                                                   1.281366365 0.6397116  7.713862
## sp|O35613|DAXX_MOUSE                                                                   -0.222557533 0.7563761  9.478064
## sp|O35638|STAG2_MOUSE;sp|Q9D3E6|STAG1_MOUSE                                             0.350861505 0.9116155  9.612877
## sp|O35639|ANXA3_MOUSE                                                                  -1.189969348 0.2960856 10.000357
## sp|O35643|AP1B1_MOUSE                                                                   0.357900323 0.2800418  9.170569
## sp|O35648|CETN3_MOUSE                                                                   0.316865372 0.4625237 10.000357
## sp|O35654|DPOD2_MOUSE                                                                  -0.860009582 1.1759010 10.000357
## sp|O35658|C1QBP_MOUSE                                                                  -0.610289479 0.2126991  9.561161
## sp|O35682|MYADM_MOUSE                                                                  -0.433615992 0.2253835  9.425397
## sp|O35685|NUDC_MOUSE                                                                    0.109344535 0.3683266 10.000357
## sp|O35691|PININ_MOUSE                                                                  -0.505265310 0.2293191  7.438079
## sp|O35704|SPTC1_MOUSE                                                                  -1.294945444 1.2371423  9.279163
## sp|O35737|HNRH1_MOUSE                                                                   0.532880140 0.3113673  9.660999
## sp|O35841|API5_MOUSE                                                                   -0.263393041 0.2134637  9.188823
## sp|O35855|BCAT2_MOUSE                                                                   3.041007335 0.6798830  8.099746
## sp|O35857|TIM44_MOUSE                                                                   0.047086431 0.2243218 10.000357
## sp|O35864|CSN5_MOUSE                                                                    0.122077873 0.2939475 10.000357
## sp|O35887|CALU_MOUSE                                                                   -0.279602230 0.3656609  9.306857
## sp|O35900|LSM2_MOUSE                                                                   -0.078911549 0.4053000  9.478061
## sp|O35943|FRDA_MOUSE                                                                   -0.733167192 0.5341609 10.000357
##                                                                                                  t         pval
## sp|A1L317|K1C24_MOUSE                                                                  -1.77417922 0.1085173292
## sp|A2A432|CUL4B_MOUSE                                                                  -1.92449258 0.0831877538
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                            -0.34130155 0.7403744086
## sp|A2A4P0|DHX8_MOUSE                                                                    0.35665999 0.7292251265
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                              1.09131092 0.3098791453
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                              -0.54021235 0.6013396767
## sp|A2A6A1|GPTC8_MOUSE                                                                  -0.01944889 0.9848712150
## sp|A2A8U2|TM201_MOUSE                                                                  -1.34995637 0.2081793334
## sp|A2A8Z1|OSBL9_MOUSE                                                                   0.50212498 0.6268051979
## sp|A2A9C3|SZT2_MOUSE                                                                    3.43767688 0.0066480506
## sp|A2ABV5|MED14_MOUSE                                                                  -1.43848507 0.1822704507
## sp|A2AGH6|MED12_MOUSE;sp|Q8BJR6|PRS27_MOUSE                                            -1.52064281 0.1620018278
## sp|A2AGH6|MED12_MOUSE;sp|Q8BQM9|MD12L_MOUSE                                            -0.59625447 0.5656103665
## sp|A2AGT5|CKAP5_MOUSE                                                                  -0.95449741 0.3635575144
## sp|A2AIV2|VIR_MOUSE                                                                    -1.14934463 0.2831295688
## sp|A2AJ15|MA1B1_MOUSE                                                                  -0.38048194 0.7122645227
## sp|A2AN08|UBR4_MOUSE                                                                    2.19014679 0.0533217602
## sp|A2APB8|TPX2_MOUSE                                                                   -0.25208102 0.8065158344
## sp|A2AQ19|RTF1_MOUSE                                                                   -0.05163351 0.9600523356
## sp|A2AR02|PPIG_MOUSE                                                                   -1.71736256 0.1191305693
## sp|A2ARP1|VIP1_MOUSE;sp|Q6ZQB6|VIP2_MOUSE                                              -0.79852567 0.4457055802
## sp|A2ASQ1|AGRIN_MOUSE                                                                  -1.39700423 0.1931921911
## sp|A2BE28|LAS1L_MOUSE                                                                  -2.10665179 0.0645659972
## sp|A2BH40|ARI1A_MOUSE                                                                  -0.04910138 0.9618053330
## sp|A2RSY1|KANL3_MOUSE                                                                  -0.38128754 0.7109654519
## sp|A2RTL5|RSRC2_MOUSE                                                                  -0.64297421 0.5347048039
## sp|A2TJV2|PALM3_MOUSE                                                                  -2.41819986 0.0377183166
## sp|A3KFU9|DISP3_MOUSE                                                                  -0.17499046 0.8649028335
## sp|A6H6E9|TT23L_MOUSE                                                                   3.12077879 0.0113993528
## sp|A6PWY4|WDR76_MOUSE                                                                   0.99367525 0.3458356898
## sp|B1ARD6|SLFN9_MOUSE                                                                   1.29398938 0.2263986718
## sp|B1AVY7|KI16B_MOUSE                                                                   2.36473139 0.0456595180
## sp|B1AVZ0|UPP_MOUSE                                                                     0.43866964 0.6707237297
## sp|B1AZI6|THOC2_MOUSE                                                                  -2.41289695 0.0375023262
## sp|B1AZP2|DLGP4_MOUSE                                                                  -1.04941329 0.3188323596
## sp|B2RQC6|PYR1_MOUSE                                                                   -1.02791365 0.3316860310
## sp|B2RXS4|PLXB2_MOUSE                                                                   0.25755264 0.8021823713
## sp|B2RY56|RBM25_MOUSE                                                                  -1.31831001 0.2167952877
## sp|B7ZMP1|XPP3_MOUSE                                                                   -1.02233280 0.3318763420
## sp|B9EJ80|PDZD8_MOUSE                                                                  -2.41220375 0.0370473087
## sp|B9EJ86|OSBL8_MOUSE                                                                  -0.67135516 0.5176039546
## sp|B9EJR8|DAAF5_MOUSE                                                                  -0.32683382 0.7508964383
## sp|C0HKD9|MFA1B_MOUSE;sp|C0HKD8|MFA1A_MOUSE                                            -1.69004833 0.1238701943
## sp|C0HKG5|RNT2A_MOUSE;sp|C0HKG6|RNT2B_MOUSE                                             0.31331580 0.7620975097
## sp|D3YXK1|SAMD1_MOUSE                                                                   0.49272559 0.6336141168
## sp|D3YXK2|SAFB1_MOUSE                                                                   1.28190583 0.2310510568
## sp|D3YXK2|SAFB1_MOUSE;sp|Q80YR5|SAFB2_MOUSE                                            -0.16266890 0.8740191915
## sp|D3YZP9|CCDC6_MOUSE                                                                  -1.92340797 0.0869196939
## sp|D3Z2R5|SELN_MOUSE                                                                   -0.17149782 0.8673916519
## sp|D3Z7P3|GLSK_MOUSE                                                                   -1.82581180 0.0999959624
## sp|E2JF22|PIEZ1_MOUSE                                                                   0.44503654 0.6671232822
## sp|E9PVA8|GCN1_MOUSE                                                                   -1.09763728 0.3005096898
## sp|E9PVX6|KI67_MOUSE                                                                    0.76185042 0.4652484900
## sp|E9PZJ8|ASCC3_MOUSE                                                                   0.29061575 0.7776682697
## sp|E9Q4N7|ARI1B_MOUSE                                                                  -0.08363634 0.9350702469
## sp|E9Q4Z2|ACACB_MOUSE;sp|Q5SWU9|ACACA_MOUSE                                             1.76946841 0.1102904518
## sp|E9Q555|RN213_MOUSE                                                                   5.21332706 0.0006056929
## sp|E9Q557|DESP_MOUSE                                                                    2.76627941 0.0208134511
## sp|E9Q5C9|NOLC1_MOUSE                                                                  -1.14595911 0.2824664781
## sp|E9Q5G3|KIF23_MOUSE                                                                   1.10670242 0.2964120437
## sp|E9Q6J5|BD1L1_MOUSE                                                                  -1.78694526 0.1053252804
## sp|E9Q784|ZC3HD_MOUSE                                                                  -2.30752513 0.0436902291
## sp|E9Q7E2|ARID2_MOUSE                                                                   0.03275266 0.9745410005
## sp|E9Q7G0|NUMA1_MOUSE                                                                   0.59610364 0.5644535296
## sp|F6ZDS4|TPR_MOUSE                                                                    -1.61966984 0.1381521807
## sp|F7BJB9|MORC3_MOUSE                                                                   3.36779484 0.0079041739
## sp|F8VPU2|FARP1_MOUSE                                                                  -1.14201245 0.2800552382
## sp|G5E829|AT2B1_MOUSE                                                                  -0.43829005 0.6708577878
## sp|G5E870|TRIPC_MOUSE                                                                  -1.20252466 0.2578721316
## sp|G5E897|PLGT3_MOUSE                                                                  -1.76465284 0.1087231978
## sp|G5E8K5|ANK3_MOUSE                                                                   -0.99822331 0.3444161952
## sp|O08528|HXK2_MOUSE                                                                   -2.48198289 0.0331758909
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE                                              -0.02582781 0.9799306877
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE;sp|Q3TRM8|HXK3_MOUSE                         -0.23719818 0.8175002876
## sp|O08529|CAN2_MOUSE                                                                   -0.49729918 0.6300008139
## sp|O08539|BIN1_MOUSE                                                                   -2.16538309 0.0561329015
## sp|O08547|SC22B_MOUSE                                                                   1.88995462 0.0892388023
## sp|O08553|DPYL2_MOUSE                                                                   0.16474686 0.8726703957
## sp|O08579|EMD_MOUSE                                                                    -1.14545346 0.2803601035
## sp|O08582|GTPB1_MOUSE                                                                   2.41117624 0.0380374395
## sp|O08583|THOC4_MOUSE                                                                  -0.40629585 0.6935741798
## sp|O08583|THOC4_MOUSE;sp|Q9JJW6|ALRF2_MOUSE                                            -0.30668010 0.7656209287
## sp|O08585|CLCA_MOUSE                                                                   -0.15928729 0.8768937509
## sp|O08600|NUCG_MOUSE                                                                   -0.92990763 0.3751685376
## sp|O08601|MTP_MOUSE                                                                     0.37875066 0.7132194582
## sp|O08638|MYH11_MOUSE;sp|Q61879|MYH10_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE -0.42305056 0.6812117184
## sp|O08638|MYH11_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE                        2.29496067 0.0471129183
## sp|O08638|MYH11_MOUSE;sp|Q8VDD5|MYH9_MOUSE                                              3.75742210 0.0041376116
## sp|O08663|MAP2_MOUSE                                                                    3.90049594 0.0034190044
## sp|O08709|PRDX6_MOUSE                                                                   0.63276065 0.5410876656
## sp|O08740|RPB11_MOUSE                                                                  -0.92976554 0.3746936802
## sp|O08749|DLDH_MOUSE                                                                   -2.10923346 0.0616667776
## sp|O08756|HCD2_MOUSE                                                                   -2.11813489 0.0602113622
## sp|O08784|TCOF_MOUSE                                                                   -1.68323738 0.1270714634
## sp|O08788|DCTN1_MOUSE                                                                   4.55655504 0.0010475827
## sp|O08795|GLU2B_MOUSE                                                                  -0.76171632 0.4650292436
## sp|O08807|PRDX4_MOUSE                                                                   0.52559880 0.6106224455
## sp|O08808|DIAP1_MOUSE                                                                   0.91573645 0.3821182901
## sp|O08810|U5S1_MOUSE                                                                   -0.40980935 0.6909777288
## sp|O08848|RO60_MOUSE                                                                   -3.31626823 0.0092703611
## sp|O08856|ELL_MOUSE                                                                     0.55114380 0.5943962336
## sp|O08915|AIP_MOUSE                                                                     0.32556457 0.7525561580
## sp|O08917|FLOT1_MOUSE                                                                  -0.37004984 0.7198933742
## sp|O08967|CYH3_MOUSE;sp|P63034|CYH2_MOUSE;sp|Q9QX11|CYH1_MOUSE                         -1.08881938 0.3047125309
## sp|O09005|DEGS1_MOUSE                                                                  -1.15561386 0.2747024513
## sp|O09044|SNP23_MOUSE                                                                  -3.05780026 0.0120892781
## sp|O09061|PSB1_MOUSE                                                                    2.22739423 0.0500622459
## sp|O09106|HDAC1_MOUSE                                                                  -0.99861111 0.3441459344
## sp|O09106|HDAC1_MOUSE;sp|P70288|HDAC2_MOUSE                                            -0.14999841 0.8839416866
## sp|O09111|NDUBB_MOUSE                                                                   0.52381837 0.6118157490
## sp|O09117|SYPL1_MOUSE                                                                  -1.87125659 0.0919302753
## sp|O09131|GSTO1_MOUSE                                                                   0.42490560 0.6807195032
## sp|O09131|GSTO1_MOUSE;sp|Q8K2Q2|GSTO2_MOUSE                                             0.95333423 0.3643104440
## sp|O09167|RL21_MOUSE                                                                    0.58964248 0.5692529164
## sp|O09172|GSH0_MOUSE                                                                    4.25999665 0.0021664829
## sp|O35054|CLD4_MOUSE                                                                   -1.21226691 0.2544464269
## sp|O35114|SCRB2_MOUSE                                                                  -1.24496953 0.2423316968
## sp|O35127|C10_MOUSE                                                                    -1.07502374 0.3097958786
## sp|O35129|PHB2_MOUSE                                                                   -0.73904714 0.4779522397
## sp|O35130|NEP1_MOUSE                                                                    0.75873496 0.4672851665
## sp|O35134|RPA1_MOUSE                                                                   -2.02133892 0.0708207900
## sp|O35144|TERF2_MOUSE                                                                  -0.50057169 0.6286370055
## sp|O35166|GOSR2_MOUSE                                                                   1.09898275 0.2975285350
## sp|O35207|CDKA1_MOUSE                                                                  -0.68103293 0.5118762857
## sp|O35218|CPSF2_MOUSE                                                                   0.73865811 0.4807090062
## sp|O35226|PSMD4_MOUSE                                                                   0.45588361 0.6584349227
## sp|O35245|PKD2_MOUSE                                                                   -0.26536736 0.7964730140
## sp|O35250|EXOC7_MOUSE                                                                  -1.78053766 0.1076361243
## sp|O35286|DHX15_MOUSE                                                                  -1.97104561 0.0775003326
## sp|O35295|PURB_MOUSE                                                                   -0.28678175 0.7806798760
## sp|O35316|SC6A6_MOUSE                                                                  -0.02512725 0.9804841008
## sp|O35326|SRSF5_MOUSE                                                                  -2.55661926 0.0291408181
## sp|O35343|IMA3_MOUSE                                                                    0.61784682 0.5507002107
## sp|O35344|IMA4_MOUSE                                                                   -2.00848425 0.0756777070
## sp|O35345|IMA7_MOUSE                                                                    1.56707560 0.1585457217
## sp|O35350|CAN1_MOUSE                                                                    1.49977664 0.1645943362
## sp|O35379|MRP1_MOUSE                                                                    1.26148005 0.2396180470
## sp|O35381|AN32A_MOUSE                                                                   0.24823598 0.8093815186
## sp|O35382|EXOC4_MOUSE                                                                   0.11232456 0.9129205297
## sp|O35387|HAX1_MOUSE                                                                    1.12080792 0.2909130000
## sp|O35427|RPC9_MOUSE                                                                   -0.59327635 0.5680568158
## sp|O35435|PYRD_MOUSE                                                                   -3.33245913 0.0079485103
## sp|O35465|FKBP8_MOUSE                                                                  -1.32233726 0.2155002763
## sp|O35516|NOTC2_MOUSE                                                                   2.86914291 0.0221347927
## sp|O35566|CD151_MOUSE                                                                   0.36437086 0.7231676493
## sp|O35593|PSDE_MOUSE                                                                    2.54579727 0.0294258601
## sp|O35609|SCAM3_MOUSE                                                                   2.00303764 0.0814614209
## sp|O35613|DAXX_MOUSE                                                                   -0.29424189 0.7749158125
## sp|O35638|STAG2_MOUSE;sp|Q9D3E6|STAG1_MOUSE                                             0.38487884 0.7087049325
## sp|O35639|ANXA3_MOUSE                                                                  -4.01900461 0.0024421872
## sp|O35643|AP1B1_MOUSE                                                                   1.27802450 0.2326404818
## sp|O35648|CETN3_MOUSE                                                                   0.68507924 0.5088611376
## sp|O35654|DPOD2_MOUSE                                                                  -0.73136222 0.4813437381
## sp|O35658|C1QBP_MOUSE                                                                  -2.86926194 0.0174288859
## sp|O35682|MYADM_MOUSE                                                                  -1.92390277 0.0850496916
## sp|O35685|NUDC_MOUSE                                                                    0.29686839 0.7726414660
## sp|O35691|PININ_MOUSE                                                                  -2.20332823 0.0611848015
## sp|O35704|SPTC1_MOUSE                                                                  -1.04672315 0.3217262970
## sp|O35737|HNRH1_MOUSE                                                                   1.71141976 0.1188550574
## sp|O35841|API5_MOUSE                                                                   -1.23390083 0.2478670408
## sp|O35855|BCAT2_MOUSE                                                                   4.47283889 0.0020124086
## sp|O35857|TIM44_MOUSE                                                                   0.20990569 0.8379559914
## sp|O35864|CSN5_MOUSE                                                                    0.41530505 0.6866887374
## sp|O35887|CALU_MOUSE                                                                   -0.76464889 0.4634271561
## sp|O35900|LSM2_MOUSE                                                                   -0.19469909 0.8497382583
## sp|O35943|FRDA_MOUSE                                                                   -1.37255877 0.1998859513
##                                                                                           adjPval
## sp|A1L317|K1C24_MOUSE                                                                  0.42107823
## sp|A2A432|CUL4B_MOUSE                                                                  0.37530970
## sp|A2A432|CUL4B_MOUSE;sp|Q3TCH7|CUL4A_MOUSE                                            0.89898624
## sp|A2A4P0|DHX8_MOUSE                                                                   0.89211003
## sp|A2A4P0|DHX8_MOUSE;sp|O35286|DHX15_MOUSE                                             0.64470734
## sp|A2A5R2|BIG2_MOUSE;sp|G3X9K3|BIG1_MOUSE                                              0.83642837
## sp|A2A6A1|GPTC8_MOUSE                                                                  0.99596595
## sp|A2A8U2|TM201_MOUSE                                                                  0.55143826
## sp|A2A8Z1|OSBL9_MOUSE                                                                  0.84578257
## sp|A2A9C3|SZT2_MOUSE                                                                   0.13510497
## sp|A2ABV5|MED14_MOUSE                                                                  0.52650895
## sp|A2AGH6|MED12_MOUSE;sp|Q8BJR6|PRS27_MOUSE                                            0.50103215
## sp|A2AGH6|MED12_MOUSE;sp|Q8BQM9|MD12L_MOUSE                                            0.82087624
## sp|A2AGT5|CKAP5_MOUSE                                                                  0.67901010
## sp|A2AIV2|VIR_MOUSE                                                                    0.62185484
## sp|A2AJ15|MA1B1_MOUSE                                                                  0.88390229
## sp|A2AN08|UBR4_MOUSE                                                                   0.30983612
## sp|A2APB8|TPX2_MOUSE                                                                   0.92529444
## sp|A2AQ19|RTF1_MOUSE                                                                   0.98740988
## sp|A2AR02|PPIG_MOUSE                                                                   0.43654947
## sp|A2ARP1|VIP1_MOUSE;sp|Q6ZQB6|VIP2_MOUSE                                              0.73813398
## sp|A2ASQ1|AGRIN_MOUSE                                                                  0.54222974
## sp|A2BE28|LAS1L_MOUSE                                                                  0.33476926
## sp|A2BH40|ARI1A_MOUSE                                                                  0.98776195
## sp|A2RSY1|KANL3_MOUSE                                                                  0.88390229
## sp|A2RTL5|RSRC2_MOUSE                                                                  0.80222369
## sp|A2TJV2|PALM3_MOUSE                                                                  0.26683476
## sp|A3KFU9|DISP3_MOUSE                                                                  0.95227317
## sp|A6H6E9|TT23L_MOUSE                                                                  0.16092393
## sp|A6PWY4|WDR76_MOUSE                                                                  0.66797069
## sp|B1ARD6|SLFN9_MOUSE                                                                  0.56738243
## sp|B1AVY7|KI16B_MOUSE                                                                  0.29277284
## sp|B1AVZ0|UPP_MOUSE                                                                    0.86762952
## sp|B1AZI6|THOC2_MOUSE                                                                  0.26683476
## sp|B1AZP2|DLGP4_MOUSE                                                                  0.65219834
## sp|B2RQC6|PYR1_MOUSE                                                                   0.65837085
## sp|B2RXS4|PLXB2_MOUSE                                                                  0.92382911
## sp|B2RY56|RBM25_MOUSE                                                                  0.55823405
## sp|B7ZMP1|XPP3_MOUSE                                                                   0.65837085
## sp|B9EJ80|PDZD8_MOUSE                                                                  0.26683476
## sp|B9EJ86|OSBL8_MOUSE                                                                  0.79310348
## sp|B9EJR8|DAAF5_MOUSE                                                                  0.90090460
## sp|C0HKD9|MFA1B_MOUSE;sp|C0HKD8|MFA1A_MOUSE                                            0.44521279
## sp|C0HKG5|RNT2A_MOUSE;sp|C0HKG6|RNT2B_MOUSE                                            0.90385120
## sp|D3YXK1|SAMD1_MOUSE                                                                  0.84800782
## sp|D3YXK2|SAFB1_MOUSE                                                                  0.57034742
## sp|D3YXK2|SAFB1_MOUSE;sp|Q80YR5|SAFB2_MOUSE                                            0.95460394
## sp|D3YZP9|CCDC6_MOUSE                                                                  0.38676454
## sp|D3Z2R5|SELN_MOUSE                                                                   0.95255275
## sp|D3Z7P3|GLSK_MOUSE                                                                   0.40771547
## sp|E2JF22|PIEZ1_MOUSE                                                                  0.86599874
## sp|E9PVA8|GCN1_MOUSE                                                                   0.63646971
## sp|E9PVX6|KI67_MOUSE                                                                   0.75583989
## sp|E9PZJ8|ASCC3_MOUSE                                                                  0.91134076
## sp|E9Q4N7|ARI1B_MOUSE                                                                  0.97790463
## sp|E9Q4Z2|ACACB_MOUSE;sp|Q5SWU9|ACACA_MOUSE                                            0.42310525
## sp|E9Q555|RN213_MOUSE                                                                  0.06703115
## sp|E9Q557|DESP_MOUSE                                                                   0.20701106
## sp|E9Q5C9|NOLC1_MOUSE                                                                  0.62185484
## sp|E9Q5G3|KIF23_MOUSE                                                                  0.63399255
## sp|E9Q6J5|BD1L1_MOUSE                                                                  0.41902705
## sp|E9Q784|ZC3HD_MOUSE                                                                  0.28590559
## sp|E9Q7E2|ARID2_MOUSE                                                                  0.99251090
## sp|E9Q7G0|NUMA1_MOUSE                                                                  0.81998000
## sp|F6ZDS4|TPR_MOUSE                                                                    0.46462131
## sp|F7BJB9|MORC3_MOUSE                                                                  0.14191032
## sp|F8VPU2|FARP1_MOUSE                                                                  0.62185484
## sp|G5E829|AT2B1_MOUSE                                                                  0.86762952
## sp|G5E870|TRIPC_MOUSE                                                                  0.59707204
## sp|G5E897|PLGT3_MOUSE                                                                  0.42107823
## sp|G5E8K5|ANK3_MOUSE                                                                   0.66736219
## sp|O08528|HXK2_MOUSE                                                                   0.25486815
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE                                              0.99411377
## sp|O08528|HXK2_MOUSE;sp|P17710|HXK1_MOUSE;sp|Q3TRM8|HXK3_MOUSE                         0.92924302
## sp|O08529|CAN2_MOUSE                                                                   0.84669207
## sp|O08539|BIN1_MOUSE                                                                   0.31544348
## sp|O08547|SC22B_MOUSE                                                                  0.39151008
## sp|O08553|DPYL2_MOUSE                                                                  0.95460394
## sp|O08579|EMD_MOUSE                                                                    0.62185484
## sp|O08582|GTPB1_MOUSE                                                                  0.26794583
## sp|O08583|THOC4_MOUSE                                                                  0.87787534
## sp|O08583|THOC4_MOUSE;sp|Q9JJW6|ALRF2_MOUSE                                            0.90555367
## sp|O08585|CLCA_MOUSE                                                                   0.95490191
## sp|O08600|NUCG_MOUSE                                                                   0.68630442
## sp|O08601|MTP_MOUSE                                                                    0.88390229
## sp|O08638|MYH11_MOUSE;sp|Q61879|MYH10_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE 0.87115003
## sp|O08638|MYH11_MOUSE;sp|Q6URW6|MYH14_MOUSE;sp|Q8VDD5|MYH9_MOUSE                       0.29595295
## sp|O08638|MYH11_MOUSE;sp|Q8VDD5|MYH9_MOUSE                                             0.10974074
## sp|O08663|MAP2_MOUSE                                                                   0.10513914
## sp|O08709|PRDX6_MOUSE                                                                  0.80334114
## sp|O08740|RPB11_MOUSE                                                                  0.68630442
## sp|O08749|DLDH_MOUSE                                                                   0.32810849
## sp|O08756|HCD2_MOUSE                                                                   0.32380949
## sp|O08784|TCOF_MOUSE                                                                   0.45146778
## sp|O08788|DCTN1_MOUSE                                                                  0.07795178
## sp|O08795|GLU2B_MOUSE                                                                  0.75583444
## sp|O08807|PRDX4_MOUSE                                                                  0.84041467
## sp|O08808|DIAP1_MOUSE                                                                  0.68994128
## sp|O08810|U5S1_MOUSE                                                                   0.87680791
## sp|O08848|RO60_MOUSE                                                                   0.14926719
## sp|O08856|ELL_MOUSE                                                                    0.83299928
## sp|O08915|AIP_MOUSE                                                                    0.90171077
## sp|O08917|FLOT1_MOUSE                                                                  0.88782626
## sp|O08967|CYH3_MOUSE;sp|P63034|CYH2_MOUSE;sp|Q9QX11|CYH1_MOUSE                         0.64149042
## sp|O09005|DEGS1_MOUSE                                                                  0.61570633
## sp|O09044|SNP23_MOUSE                                                                  0.16533032
## sp|O09061|PSB1_MOUSE                                                                   0.30323170
## sp|O09106|HDAC1_MOUSE                                                                  0.66736219
## sp|O09106|HDAC1_MOUSE;sp|P70288|HDAC2_MOUSE                                            0.95840193
## sp|O09111|NDUBB_MOUSE                                                                  0.84097642
## sp|O09117|SYPL1_MOUSE                                                                  0.39685314
## sp|O09131|GSTO1_MOUSE                                                                  0.87115003
## sp|O09131|GSTO1_MOUSE;sp|Q8K2Q2|GSTO2_MOUSE                                            0.67915381
## sp|O09167|RL21_MOUSE                                                                   0.82263075
## sp|O09172|GSH0_MOUSE                                                                   0.09231213
## sp|O35054|CLD4_MOUSE                                                                   0.59387319
## sp|O35114|SCRB2_MOUSE                                                                  0.58189525
## sp|O35127|C10_MOUSE                                                                    0.64470734
## sp|O35129|PHB2_MOUSE                                                                   0.76651891
## sp|O35130|NEP1_MOUSE                                                                   0.75707958
## sp|O35134|RPA1_MOUSE                                                                   0.34750556
## sp|O35144|TERF2_MOUSE                                                                  0.84663115
## sp|O35166|GOSR2_MOUSE                                                                  0.63410224
## sp|O35207|CDKA1_MOUSE                                                                  0.78876711
## sp|O35218|CPSF2_MOUSE                                                                  0.76812516
## sp|O35226|PSMD4_MOUSE                                                                  0.86162767
## sp|O35245|PKD2_MOUSE                                                                   0.92180232
## sp|O35250|EXOC7_MOUSE                                                                  0.42104365
## sp|O35286|DHX15_MOUSE                                                                  0.36225456
## sp|O35295|PURB_MOUSE                                                                   0.91257437
## sp|O35316|SC6A6_MOUSE                                                                  0.99411377
## sp|O35326|SRSF5_MOUSE                                                                  0.24290953
## sp|O35343|IMA3_MOUSE                                                                   0.81076595
## sp|O35344|IMA4_MOUSE                                                                   0.35998322
## sp|O35345|IMA7_MOUSE                                                                   0.49543483
## sp|O35350|CAN1_MOUSE                                                                   0.50371046
## sp|O35379|MRP1_MOUSE                                                                   0.57775674
## sp|O35381|AN32A_MOUSE                                                                  0.92602768
## sp|O35382|EXOC4_MOUSE                                                                  0.96938043
## sp|O35387|HAX1_MOUSE                                                                   0.63226222
## sp|O35427|RPC9_MOUSE                                                                   0.82180451
## sp|O35435|PYRD_MOUSE                                                                   0.14197824
## sp|O35465|FKBP8_MOUSE                                                                  0.55762677
## sp|O35516|NOTC2_MOUSE                                                                  0.21447394
## sp|O35566|CD151_MOUSE                                                                  0.88993897
## sp|O35593|PSDE_MOUSE                                                                   0.24412307
## sp|O35609|SCAM3_MOUSE                                                                  0.36990458
## sp|O35613|DAXX_MOUSE                                                                   0.91030717
## sp|O35638|STAG2_MOUSE;sp|Q9D3E6|STAG1_MOUSE                                            0.88360968
## sp|O35639|ANXA3_MOUSE                                                                  0.09596146
## sp|O35643|AP1B1_MOUSE                                                                  0.57079141
## sp|O35648|CETN3_MOUSE                                                                  0.78672959
## sp|O35654|DPOD2_MOUSE                                                                  0.76843795
## sp|O35658|C1QBP_MOUSE                                                                  0.18891186
## sp|O35682|MYADM_MOUSE                                                                  0.38223231
## sp|O35685|NUDC_MOUSE                                                                   0.90894414
## sp|O35691|PININ_MOUSE                                                                  0.32653657
## sp|O35704|SPTC1_MOUSE                                                                  0.65436035
## sp|O35737|HNRH1_MOUSE                                                                  0.43654947
## sp|O35841|API5_MOUSE                                                                   0.58782944
## sp|O35855|BCAT2_MOUSE                                                                  0.09032619
## sp|O35857|TIM44_MOUSE                                                                  0.93608294
## sp|O35864|CSN5_MOUSE                                                                   0.87421719
## sp|O35887|CALU_MOUSE                                                                   0.75393052
## sp|O35900|LSM2_MOUSE                                                                   0.94377655
## sp|O35943|FRDA_MOUSE                                                                   0.54501613
##  [ reached 'max' / getOption("max.print") -- omitted 3335 rows ]
```

``` r
#rownames(res_df)

grep("*Q3V0J1*", rownames(res_df)) -> check

res_df[check,]
```

```
## [1] logFC   se      df      t       pval    adjPval
## <0 rows> (or 0-length row.names)
```



``` r
sigNames <- rowData(qf_prot[["proteins"]])$conditionWT %>%
    rownames_to_column("proteins") %>%
    filter(adjPval < 0.05) %>%
    pull(proteins)

#pdf("heatmap.pdf", width = 9, height = 6)
heatmap(assay(qf_prot[["proteins"]])[sigNames, ])
```

![plot of chunk unnamed-chunk-40](figure/unnamed-chunk-40-1.png)

``` r
#dev.off()
```

Get results table from PRIDE

``` r
# Download mztab file 
#pxget(px, grep("mztab", pxfiles(px)))

resFile <-  list.files(path="/Users/castleti/Library/Caches/org.R-project.R/R/rpx", 
                        pattern = "*.mztab",
                        full.names = TRUE) 

res <- readMzTabData(resFile)
res@featureData # 4923 proteins
```

```
## An object of class 'AnnotatedDataFrame'
##   featureNames: tr.E9PZ21.E9PZ21_MOUSE sp.Q8K4F6.NSUN5_MOUSE ... tr.E9QAE4.E9QAE4_MOUSE (4923 total)
##   varLabels: accession description ... modifications (32 total)
##   varMetadata: labelDescription
```

